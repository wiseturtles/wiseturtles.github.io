<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <title>Wise Turtles</title>
    <meta name="description" content="">
    <meta name="author" content="crazygit">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://blog.wiseturtles.com/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="http://blog.wiseturtles.com/theme/bootstrap.min.css" rel="stylesheet">
    <link href="http://blog.wiseturtles.com/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="http://blog.wiseturtles.com/theme/local.css" rel="stylesheet">
    <link href="http://blog.wiseturtles.com/theme/pygments/emacs.css" rel="stylesheet">

    <link rel="shortcut icon" href="http://blog.wiseturtles.com/theme/images/favicon.ico">
    <link rel="Bookmark" href="http://blog.wiseturtles.com/theme/images/favicon.ico">

    <!-- baidu -->
    <meta name="baidu-site-verification" content="lTsGMtiPuN" />

    <!-- use useso fonts instead of google online fonts-->
    <link href='http://fonts.useso.com/css?family=Tangerine' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Rancho&effect=fire-animation' rel='stylesheet' type='text/css'>


</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="http://blog.wiseturtles.com">Wise Turtles</a>

        <div class="nav-collapse">
        <ul class="nav">

        </ul>
        </div>

    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">



    <div class='article'>
        <div class="content-title">
            <a href="http://blog.wiseturtles.com/posts/linux-ps.html"><h1>ps</h1></a>
2015-01-13

by <a class="url fn" href="http://blog.wiseturtles.com/author/crazygit.html">crazygit</a>
 


        </div>

        <div><p>本文参考：</p>
<ul>
<li><a href="http://www.binarytides.com/linux-ps-command/">10 basic examples of Linux ps&nbsp;command</a></li>
<li><a href="http://man.linuxde.net/ps">http://man.linuxde.net/ps</a></li>
</ul>
<h2>作用</h2>
<p>ps命令用来列出系统中当前运行的那些进程。ps命令列出的是当前那些进程的快照，就是执行ps命令的那个时刻的那些进程，如果想要动态的显示进程信息，可以使用top命令&nbsp;。</p>
<h2>参数形式</h2>
<ul>
<li>Unix风格的参数，前面加单破折线</li>
<li><span class="caps">BSD</span>风格的参数，&nbsp;前面不加破折线</li>
<li><span class="caps">GNU</span>风格的长参数，前面加双破折线</li>
</ul>
<p>不同风格的参数可以混合使用,&nbsp;但是要注意避免冲突。</p>
<p>如:</p>
<p>命令<code>ps -aux</code>和<code>ps aux</code>是不一样的。<code>ps -aux</code>是显示所有&#8217;x&#8217;用户的进程, 如果用户&#8217;x&#8217;不存在的话，会给出警告，并当做<code>ps aux</code>来处理。</p>
<h2>使用示例</h2>
<ol>
<li>
<p>显示所有进程</p>
<div class="highlight"><pre><span class="nv">$ </span>ps aux
<span class="nv">$ </span>ps -ef
</pre></div>


</li>
<li>
<p>显示指定用户的进程</p>
<div class="highlight"><pre><span class="nv">$ </span>ps -f -u www-data

<span class="c"># 多个用户用&#39;,&#39;隔开</span>
<span class="nv">$ </span>ps -f -u www-data,root
</pre></div>


</li>
<li>
<p>按照进程名来指定</p>
<div class="highlight"><pre><span class="nv">$ </span>ps -C nginx
</pre></div>


<p>-C&nbsp;选项必须提供精确的进程名，不提供模糊匹配，一般使用grep来搜索</p>
<div class="highlight"><pre><span class="nv">$ </span>ps -ef <span class="p">|</span>grep nginx
</pre></div>


</li>
<li>
<p>按照进程id来查找</p>
<div class="highlight"><pre><span class="nv">$ </span>ps -f -p 3150,7298,6455
</pre></div>


</li>
<li>
<p>按照<span class="caps">CPU</span>或内存使用情况排序</p>
<p>使用&#8212;sort选项可以按照一定的顺序排序，并且可以在指定的排序列前添加&#8217;-&#8216;或&#8217;+&#8217;&nbsp;来指定降序或升序排列</p>
<div class="highlight"><pre>    # cpu 使用前５
    $ ps aux --sort=-pcpu | head -5

    # 内存 使用前５
    $ ps aux --sort=-pmem | head -5

    # 指定多个排序
    $ ps jax --sort=uid,-ppid,+pid
</pre></div>


<p>排序选项参见man page <code>STANDARD FORMAT SPECIFIERS</code>部分</p>
<p>部分选项列出如下
<pre>
   cmd          simple name of executable
   pcpu         cpu utilization
   pmem         ratio of the process's resident set size to the
                physical memory on the machine, expressed as a
                percentage
   flags        flags as in long format F field
   pgrp         process group ID
   tpgid        controlling tty process group ID
   cutime       cumulative user time
   cstime       cumulative system time
   utime        user time
   min_flt      number of minor page faults
   maj_flt      number of major page faults
   cmin_flt     cumulative minor page faults
   cmaj_flt     cumulative major page faults
   session      session ID
   pid          process ID
   ppid         parent process ID
   rss          resident set size
   resident     resident pages
   size         approximate amount of swap space that would be
                required if the process were to dirty all writable
                pages and then be swapped out. This number is
                very rough!
   share        amount of shared pages
   tty          the device number of the controlling tty
   start_time   time process was started
   uid          user ID number
   user         user name
   vsize        total VM size in kB
   priority     kernel scheduling priority
</pre></p>
</li>
<li>
<p>按照树状结构显示</p>
<p>使用<code>--forest</code>选项</p>
<div class="highlight"><pre><span class="nv">$ </span>ps -f --forest -C nginx
UID        PID  PPID  C STIME TTY          TIME CMD
root      <span class="m">1344</span>     <span class="m">1</span>  <span class="m">0</span>  <span class="m">2014</span> ?        00:00:00 nginx: master process /usr/sbin/nginx
www-data  <span class="m">1345</span>  <span class="m">1344</span>  <span class="m">0</span>  <span class="m">2014</span> ?        00:01:52  <span class="se">\_</span> nginx: worker process
www-data  <span class="m">1346</span>  <span class="m">1344</span>  <span class="m">0</span>  <span class="m">2014</span> ?        00:02:05  <span class="se">\_</span> nginx: worker process
www-data  <span class="m">1348</span>  <span class="m">1344</span>  <span class="m">0</span>  <span class="m">2014</span> ?        00:02:00  <span class="se">\_</span> nginx: worker process
www-data  <span class="m">1349</span>  <span class="m">1344</span>  <span class="m">0</span>  <span class="m">2014</span> ?        00:01:04  <span class="se">\_</span> nginx: worker process
</pre></div>


<p>不要把<code>--forest</code>和<code>--sort</code>选项混合使用，因为他们都会影响结果</p>
</li>
<li>
<p>列出子进程</p>
<div class="highlight"><pre>＃先列出所有nginx进程
$ ps -o pid,uname,comm -C nginx
PID USER     COMMAND
1344 root     nginx
1345 www-data nginx
1346 www-data nginx
1348 www-data nginx
1349 www-data nginx

# 使用--ppid选项列出子进程
$ ps --ppid 2359
PID TTY          TIME CMD
4524 ?        00:00:00 apache2
4525 ?        00:00:00 apache2
4526 ?        00:00:00 apache2
4527 ?        00:00:00 apache2
4528 ?        00:00:00 apache2
</pre></div>


</li>
<li>
<p>列出进程的线程</p>
<p>使用<code>-L</code>选项</p>
<div class="highlight"><pre><span class="nv">$ </span>ps -p <span class="m">3150</span> -L
</pre></div>


</li>
<li>
<p>指定输出结果的列</p>
<p>可以输出的列信息与<code>--sort</code>选项一样，可以查看man page 的<code>STANDARD FORMAT SPECIFIERS</code>部分</p>
<div class="highlight"><pre><span class="nv">$ </span>ps -e -o pid,uname,pcpu,pmem,comm

<span class="c"># 显示指定的列并给出别名</span>
<span class="nv">$ </span>ps -e -o pid,uname<span class="o">=</span>USERNAME,pcpu<span class="o">=</span>CPU_USAGE,pmem,comm
</pre></div>


</li>
<li>
<p>将ps转变为实时更新的效果</p>
<div class="highlight"><pre><span class="nv">$ </span> watch -n <span class="m">1</span> <span class="s1">&#39;ps -e -o pid,uname,cmd,pmem,pcpu --sort=-pmem,-pcpu | head -15&#39;</span>
</pre></div>


</li>
<li>
<p>部分选项解释</p>
</li>
</ol>
<pre>
-a： 显示所有终端机下执行的程序，除了阶段作业领导者之外。
a：  显示现行终端机下的所有程序，包括其他用户的程序。
-A： 显示所有程序。
-c： 显示CLS和PRI栏位。
c：  列出程序时，显示每个程序真正的指令名称，而不包含路径，选项或常驻服务的标示。
-C<指令名称>： 指定执行指令的名称，并列出该指令的程序的状况。
-d： 显示所有程序，但不包括阶段作业领导者的程序。
-e： 此选项的效果和指定"A"选项相同。
e：  列出程序时，显示每个程序所使用的环境变量。
-f： 显示UID,PPIP,C与STIME栏位。
f：  用ASCII字符显示树状结构，表达程序间的相互关系。
-g<群组名称>： 此选项的效果和指定"-G"选项相同，当亦能使用阶段作业领导者的名称来指定。
g：  显示现行终端机下的所有程序，包括群组领导者的程序。 -G<群组识别码>：列出属于该群组的程序的状况，也可使用群组名称来指定。
h：  不显示标题列。
-H： 显示树状结构，表示程序间的相互关系。
-j或j： 采用工作控制的格式显示程序状况。
-l或l： 采用详细的格式来显示程序状况。
L：  列出栏位的相关信息。
-m或m： 显示所有的执行绪。
n：  以数字来表示USER和WCHAN栏位。
-N： 显示所有的程序，除了执行ps指令终端机下的程序之外。
-p<程序识别码>： 指定程序识别码，并列出该程序的状况。
p<程序识别码>：  此选项的效果和指定"-p"选项相同，只在列表格式方面稍有差异。
r：  只列出现行终端机正在执行中的程序。
-s<阶段作业>：   指定阶段作业的程序识别码，并列出隶属该阶段作业的程序的状况。
s：  采用程序信号的格式显示程序状况。
S：  列出程序时，包括已中断的子程序资料。
-t<终端机编号>：  指定终端机编号，并列出属于该终端机的程序的状况。
t<终端机编号>：   此选项的效果和指定"-t"选项相同，只在列表格式方面稍有差异。
-T：   显示现行终端机下的所有程序。
-u<用户识别码>：  此选项的效果和指定"-U"选项相同。
u：  以用户为主的格式来显示程序状况。
-U<用户识别码>：  列出属于该用户的程序的状况，也可使用用户名称来指定。
U<用户名称>：  列出属于该用户的程序的状况。
v：  采用虚拟内存的格式显示程序状况。
-V或V：  显示版本信息。
-w或w：  采用宽阔的格式来显示程序状况。　
x：  显示所有程序，不以终端机来区分。
X：  采用旧式的Linux i386登陆格式显示程序状况。
-y：  配合选项"-l"使用时，不显示F(flag)栏位，并以RSS栏位取代ADDR栏位　。
-<程序识别码>：  此选项的效果和指定"p"选项相同。
--cols<每列字符数>：  设置每列的最大字符数。
--columns<每列字符数>：  此选项的效果和指定"--cols"选项相同。
--cumulative：  此选项的效果和指定"S"选项相同。
--deselect：  此选项的效果和指定"-N"选项相同。
--forest：  此选项的效果和指定"f"选项相同。
--headers：  重复显示标题列。
--help：  在线帮助。
--info：  显示排错信息。
--lines<显示列数>：  设置显示画面的列数。
--no-headers：  此选项的效果和指定"h"选项相同，只在列表格式方面稍有差异。
--group<群组名称>：  此选项的效果和指定"-G"选项相同。
--Group<群组识别码>：  此选项的效果和指定"-G"选项相同。
--pid<程序识别码>：  此选项的效果和指定"-p"选项相同。
--rows<显示列数>：  此选项的效果和指定"--lines"选项相同。
--sid<阶段作业>：  此选项的效果和指定"-s"选项相同。
--tty<终端机编号>：  此选项的效果和指定"-t"选项相同。
--user<用户名称>：  此选项的效果和指定"-U"选项相同。
--User<用户识别码>：  此选项的效果和指定"-U"选项相同。
--version：  此选项的效果和指定"-V"选项相同。
--widty<每列字符数>：  此选项的效果和指定"-cols"选项相同。
</pre></div>
        <hr />
    </div>


 


    <div class='article'>
        <a href="http://blog.wiseturtles.com/posts/linux-free.html"><h2>free</h2></a>
        <div class= "well small"> 2015-01-09

by <a class="url fn" href="http://blog.wiseturtles.com/author/crazygit.html">crazygit</a>
 


 </div>
        <div class="summary"><p>the usage of&nbsp;free</p> <a class="btn btn-info xsmall" href="http://blog.wiseturtles.com/posts/linux-free.html">更多详情</a></div>
    </div>


 


    <div class='article'>
        <a href="http://blog.wiseturtles.com/posts/linux-uptime.html"><h2>uptime</h2></a>
        <div class= "well small"> 2014-12-15

by <a class="url fn" href="http://blog.wiseturtles.com/author/crazygit.html">crazygit</a>
 


 </div>
        <div class="summary"><p>the usage of&nbsp;uptime</p> <a class="btn btn-info xsmall" href="http://blog.wiseturtles.com/posts/linux-uptime.html">更多详情</a></div>
    </div>

<div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Previous</a></li>

    <li class="active"><a href="http://blog.wiseturtles.com/category/linux-commands.html">1</a></li>

    <li class="next disabled"><a href="#">&rarr; Next</a></li>

</ul>
</div>
 
  
        </div>

        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                站内
                </li>

                <li><a href="http://blog.wiseturtles.com/">存档</a>
                <li><a href="http://blog.wiseturtles.com/tags.html">标签</a>
                <li><a href="http://blog.wiseturtles.com/feeds/all.atom.xml" rel="alternate">Atom订阅</a></li>
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                分类
                </li>

                <li><a href="http://blog.wiseturtles.com/category/android.html">android</a></li>
                <li><a href="http://blog.wiseturtles.com/category/linux-commands.html">linux-commands</a></li>
                <li><a href="http://blog.wiseturtles.com/category/mysql.html">mysql</a></li>
                <li><a href="http://blog.wiseturtles.com/category/pelican.html">pelican</a></li>
                <li><a href="http://blog.wiseturtles.com/category/ubuntu.html">Ubuntu</a></li>
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                友情链接
                </li>

                <li><a href="https://travis-ci.org/">Travis-ci</a></li>
                <li><a href="http://wercker.com/">Wercker</a></li>
                <li><a href="http://www.cloudbees.com">Cloudbees</a></li>
                <li><a href="http://docs.getpelican.com/">Pelican</a></li>
                <li><a href="http://jinja.pocoo.org/">Jinja</a></li>
            </ul>
            </div>



        </div>     </div>     </div> 
<footer>
<br />
<p align="center"><a href="http://blog.wiseturtles.com">Wise Turtles</a> &copy; crazygit 2014, Powered by <a href="http://getpelican.com/">Pelican</a>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Ffcdd4a94883b9017bfe908b983068ee7' type='text/javascript'%3E%3C/script%3E"));
</script></p>
</footer>

</div> <!-- /container -->
<!-- use baidu jquery cdn instead of google" -->
<script src="http://libs.baidu.com/jquery/1.7.1/jquery.min.js"></script>
<script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-collapse.js"></script>
<a href="https://github.com/wiseturtles"><img style="position: absolute; top: 50px; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" /></a>
</body>
</html>