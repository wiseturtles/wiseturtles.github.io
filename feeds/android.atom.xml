<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Wise Turtles</title><link href="http://blog.wiseturtles.com/" rel="alternate"></link><link href="http://blog.wiseturtles.com/feeds/android.atom.xml" rel="self"></link><id>http://blog.wiseturtles.com/</id><updated>2015-01-11T15:20:00+08:00</updated><entry><title>export Android cantacts with vCard format via adb</title><link href="http://blog.wiseturtles.com/posts/android-vcard-from-command-line.html" rel="alternate"></link><updated>2015-01-11T15:20:00+08:00</updated><author><name>Zhang Wanming</name></author><id>tag:blog.wiseturtles.com,2015-01-11:posts/android-vcard-from-command-line.html</id><summary type="html">&lt;p&gt;参考:
&lt;a href="http://www.commandlinefu.com/commands/view/11688/dump-android-contacts-sms"&gt;http://www.commandlinefu.com/commands/view/11688/dump-android-contacts-sms&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;昨天手机(&lt;span class="caps"&gt;TCL&lt;/span&gt;&amp;nbsp;S960)掉地下把屏幕摔坏了，Google被xx后，就没在用过其它通讯录同步，只好想办法从坏手机里导出，屏幕完全坏了，只能通过adb完成。&lt;/p&gt;
&lt;h1&gt;获取通讯录&lt;/h1&gt;
&lt;p&gt;通过adb从手机中导出通讯录，可以用如下方法：
1. am
&lt;pre&gt;
$ adb shell am start -t "text/x-vcard" -d "file:///sdcard/contacts.vcf" -a android.intent.action.VIEW com.android.contacts
&lt;/pre&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;get contacts.db
&lt;pre&gt;
$ adb pull /data/data/com.android.providers.contacts/databases/contacts2.db .
sqlite3 -batch &amp;lt;&lt;EOF contacts2.db &lt;CR&gt; .header on &lt;CR&gt; .mode tabs &lt;CR&gt; select * from data; &lt;CR&gt; EOF
&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;方法一无法运行报错，方法二需要root权限。&lt;/p&gt;
&lt;p&gt;Android拿root权限貌似就两种方法: xx root工具(通过系统漏洞获取root权限); 刷recory分区。&amp;nbsp;我没找到该机型的recory，而是用360一键root，拿到root权限。&lt;/p&gt;
&lt;p&gt;有了root权限，通过方法二就可以拿到通讯录数据了，剩下的就是生成vCard格式。&amp;nbsp;github上已经有人写了通过contacts2.db生成vCard文件的小工具。&lt;/p&gt;
&lt;pre&gt;
$ git clone git@github.com:stachre/dump-contacts2db.git
$ cd dump-contacts2db
$ bash dump-contacts2db.sh path/to/contacts2.db &gt; path/to/contacts.vcf
&lt;/pre&gt;

&lt;p&gt;如果还希望获取手机里的短信，可以用下面的命令:
&lt;pre&gt;
$ adb pull /data/data/com.android.providers.telephony/databases/mmssms.db
$ sqlite3 -batch &amp;lt;&lt;EOF mmssms.db &lt;CR&gt; .header on &lt;CR&gt; .mode tabs &lt;CR&gt; select * from sms; &lt;CR&gt; EOF
&lt;/pre&gt;&lt;/p&gt;
&lt;h1&gt;Android解锁&lt;/h1&gt;
&lt;p&gt;Android解锁我没试过，命令如下：
&lt;pre&gt;
adb shell
cd /data/data/com.android.providers.settings/databases
sqlite3 settings.db
update system set value=0 where name=’lock_pattern_autolock';
update secure set value=0 where name=’lock_pattern_autolock';
update system set value=0 where name=’lockscreen.lockedoutpermanently';
update secure set value=0 where name=’lockscreen.lockedoutpermanently';
.quit
&lt;/pre&gt;&lt;/p&gt;
&lt;p&gt;如果是忘了Android锁屏图案，想找回，可以试试&amp;nbsp;https://github.com/sch3m4/androidpatternlock&lt;/p&gt;</summary><category term="Android"></category><category term="vCard"></category><category term="adb"></category></entry></feed>