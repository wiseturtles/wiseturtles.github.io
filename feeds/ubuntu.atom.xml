<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Wise Turtles</title><link href="http://blog.wiseturtles.com/" rel="alternate"></link><link href="http://blog.wiseturtles.com/feeds/ubuntu.atom.xml" rel="self"></link><id>http://blog.wiseturtles.com/</id><updated>2015-01-20T18:16:00+08:00</updated><entry><title>linux 小贴士</title><link href="http://blog.wiseturtles.com/posts/linux-tips.html" rel="alternate"></link><updated>2015-01-20T18:16:00+08:00</updated><author><name>crazygit</name></author><id>tag:blog.wiseturtles.com,2015-01-20:posts/linux-tips.html</id><summary type="html">&lt;h2&gt;ssh端口转发&lt;/h2&gt;
&lt;p&gt;由于服务器上一些服务的端口没有对外开发，但是在开发时又想直接使用服务器上的这些服务，该怎么办？&lt;/p&gt;
&lt;p&gt;以我们服务器A(192.167.0.1) 为例, 上面有Elasticsheach数据库为例, 由于Elasticsearch数据库比较&amp;nbsp;大，从服务器上将数据拷贝到本地不太现实，便可以通过ssh端口转发来实现。&lt;/p&gt;
&lt;p&gt;前提:&amp;nbsp;本地服务器可以通过ssh登陆到服务器A(192.167.0.1)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;ssh -fNL 9200:localhost:9200 192.167.0.1
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;通过上面命令可以在本地机器和服务器A的9200端口之间做一个隧道，访问本地的9200端&amp;nbsp;口就跟直接访问服务器A上的9200端口一样。&lt;/p&gt;
&lt;p&gt;为了使用方便，可以为上面的命令设置一个别名,添加到&lt;code&gt;~/.bashrc&lt;/code&gt;中，&amp;nbsp;如&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;&lt;span class="nb"&gt;alias &lt;/span&gt;&lt;span class="nv"&gt;sshes&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ssh -fNL 9200:localhost:9200 192.167.0.1&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;那么以后使用&lt;code&gt;sshes&lt;/code&gt;就可以方便的建立一个ssh隧道连接,　同理，此法可用于连接服务器上的mysql及其它服务.&lt;/p&gt;
&lt;p&gt;另外一个常用的是通过ssh翻墙的命令&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;ssh -qTfnN -D &lt;span class="m"&gt;7070&lt;/span&gt; 192.167.0.2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;前提是172.167.0.2是一台可以直接翻墙的机器(如国外的云主机),执行上面的命令后便可以通过本地的7070端口翻墙.&lt;/p&gt;
&lt;p&gt;更多关于ssh转发的可以查看下面的文章:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://codelife.me/blog/2012/12/09/three-types-of-ssh-turneling/"&gt;三种不同类型的ssh隧道&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ssh登陆配置&lt;/h2&gt;
&lt;p&gt;登陆到远程服务器时,当服务器上的用户名和本地的用户名不一致且端口也不是默认端口时.
以服务器A(192.168.0.1), 用户名为root, 端口为4455。我们每次登陆到远程主机或拷贝
文件时,&amp;nbsp;都需要带上用户名和端口信息。如:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# ssh登陆&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;ssh -p &lt;span class="m"&gt;4455&lt;/span&gt; root@192.168.0.1
&lt;span class="c"&gt;# scp拷贝&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;scp -P &lt;span class="m"&gt;4455&lt;/span&gt; root@192.168.0.1:/tmp/a a
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这样比较繁琐。稍微配置一下便可以化繁为简&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;cat ~/.ssh/config
Host 192.168.0.1
    User root
    Port 4455
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这样以后每次访问该服务器都不需要带上用户及端口信息&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# ssh登陆&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;ssh 192.168.0.1
&lt;span class="c"&gt;# scp拷贝&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;scp -P 192.168.0.1:/tmp/a a
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;当本机需要通过不同的key登陆到不同的服务器时，我们都是通过&lt;code&gt;-i&lt;/code&gt;来临时指定key.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# 使用a.key登陆192.168.0.1&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;ssh -i ~/.ssh/a.key 192.168.0.1
&lt;span class="c"&gt;# 使用b.key登陆192.168.0.2&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;ssh -i ~/.ssh/b.key 192.168.0.2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;稍微配置一下&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;cat ~/.ssh/config
Host 192.168.0.1
    User root
    Port 4455
    IdentityFile ~/.ssh/a.key

Host 192.168.0.2
    User root
    Port 4455
    IdentityFile ~/.ssh/b.key
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;配置之后每次登陆不同的服务器也不需要通过&lt;code&gt;-i&lt;/code&gt;参数指定key了。&lt;/p&gt;
&lt;h2&gt;~/.bashrc配置&lt;/h2&gt;
&lt;p&gt;下面介绍的都是可以添加到&lt;code&gt;~/.bashrc&lt;/code&gt;中的一些配置.&lt;/p&gt;
&lt;h3&gt;让man&amp;nbsp;page不再单调&lt;/h3&gt;
&lt;p&gt;平时使用man page的时候，都是黑白的文字。看起来很是不方便，稍微配置一下，可以让
你的man&amp;nbsp;page充满颜色。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# color man pages&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;LESS_TERMCAP_mb&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;\E[01;31m&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;LESS_TERMCAP_md&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;\E[01;31m&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;LESS_TERMCAP_me&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;\E[0m&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;LESS_TERMCAP_se&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;\E[0m&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;LESS_TERMCAP_so&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;\E[01;44;33m&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;LESS_TERMCAP_ue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;\E[0m&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;LESS_TERMCAP_us&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;\E[01;32m&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;source ~/.bashrc&lt;/code&gt;后，man一个命令可以看到效果&lt;/p&gt;
&lt;h3&gt;终端操作使用vim模式&lt;/h3&gt;
&lt;p&gt;从&lt;code&gt;@WanMing&lt;/code&gt;处习得的技能，vim控必备&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;set&lt;/span&gt; -o vi
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;效果如何，谁用谁知道&lt;/p&gt;
&lt;h3&gt;python自动激活项目的虚拟环境&lt;/h3&gt;
&lt;p&gt;重写&lt;code&gt;cd&lt;/code&gt;命令，使它在进入到python项目时，自动激活与项目名一样的虚拟环境&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;function&lt;/span&gt; workon_cwd &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="c"&gt;# Check that this is a Git repo&lt;/span&gt;
    &lt;span class="nv"&gt;GIT_DIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;git rev-parse --git-dir 2&amp;gt; /dev/null&lt;span class="sb"&gt;`&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="c"&gt;# Find the repo root and check for virtualenv name override&lt;/span&gt;
        &lt;span class="nv"&gt;GIT_DIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="se"&gt;\c&lt;/span&gt;d &lt;span class="nv"&gt;$GIT_DIR&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;pwd&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
        &lt;span class="nv"&gt;PROJECT_ROOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;dirname &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$GIT_DIR&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
        &lt;span class="nv"&gt;ENV_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;basename &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$PROJECT_ROOT&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; -f &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$PROJECT_ROOT&lt;/span&gt;&lt;span class="s2"&gt;/.venv&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="nv"&gt;ENV_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;cat &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$PROJECT_ROOT&lt;/span&gt;&lt;span class="s2"&gt;/.venv&amp;quot;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
        &lt;span class="k"&gt;fi&lt;/span&gt;
        &lt;span class="c"&gt;# Activate the environment only if it is not already active&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$VIRTUAL_ENV&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; !&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$WORKON_HOME&lt;/span&gt;&lt;span class="s2"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;$ENV_NAME&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$WORKON_HOME&lt;/span&gt;&lt;span class="s2"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;$ENV_NAME&lt;/span&gt;&lt;span class="s2"&gt;/bin/activate&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
                workon &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$ENV_NAME&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;CD_VIRTUAL_ENV&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$ENV_NAME&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
            &lt;span class="k"&gt;fi&lt;/span&gt;
        &lt;span class="k"&gt;fi&lt;/span&gt;
    &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$CD_VIRTUAL_ENV&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="c"&gt;# We&amp;#39;ve just left the repo, deactivate the environment&lt;/span&gt;
        &lt;span class="c"&gt;# Note: this only happens if the virtualenv was activated automatically&lt;/span&gt;
        deactivate &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;unset &lt;/span&gt;CD_VIRTUAL_ENV
    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="c"&gt;# New cd function that does the virtualenv magic&lt;/span&gt;
&lt;span class="k"&gt;function&lt;/span&gt; venv_cd &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; workon_cwd
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="nb"&gt;alias cd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;venv_cd&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;# init for create new terminal tab&lt;/span&gt;
workon_cwd
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;个性化终端提示符&lt;/h3&gt;
&lt;p&gt;通过设置&lt;span class="caps"&gt;PS1&lt;/span&gt;变量, 可以个性化终端提示符,&amp;nbsp;展示更多有用信息.&lt;/p&gt;
&lt;p&gt;如我的终端设置, 里面包含了项目的分支，当前&lt;span class="caps"&gt;HEAD&lt;/span&gt;值，及git库的状态信息&lt;/p&gt;
&lt;p&gt;&lt;img alt="PS1 screenshot" src="http://pic.yupoo.com/crazygit_v/En4dALxz/medium.jpg" /&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;PS1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;TITLEBAR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;SAVE_CURSOR&lt;/span&gt;&lt;span class="si"&gt;}${&lt;/span&gt;&lt;span class="nv"&gt;MOVE_CURSOR_RIGHTMOST&lt;/span&gt;&lt;span class="si"&gt;}${&lt;/span&gt;&lt;span class="nv"&gt;MOVE_CURSOR_5_LEFT&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESTORE_CURSOR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\&lt;/span&gt;
&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VIRTUALENV&lt;/span&gt;&lt;span class="p"&gt;:+(&lt;/span&gt;&lt;span class="nv"&gt;$VIRTUALENV&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="si"&gt;}${&lt;/span&gt;&lt;span class="nv"&gt;D_USER_COLOR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\u &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;D_INTERMEDIATE_COLOR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\&lt;/span&gt;
&lt;span class="s2"&gt;at &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;D_MACHINE_COLOR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\h &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;D_INTERMEDIATE_COLOR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\&lt;/span&gt;
&lt;span class="s2"&gt;in &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;D_DIR_COLOR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\w &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;D_INTERMEDIATE_COLOR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;\&lt;/span&gt;
&lt;span class="k"&gt;$(&lt;/span&gt;demula_vcprompt&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;\&lt;/span&gt;
&lt;span class="k"&gt;$(&lt;/span&gt;is_vim_shell&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如下是一个在线生成&lt;span class="caps"&gt;PS1&lt;/span&gt;变量的网站，可以根据自己的需求定制&lt;span class="caps"&gt;PS1&lt;/span&gt;变量:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://bashrcgenerator.com/"&gt;http://bashrcgenerator.com/&lt;/a&gt;&lt;/p&gt;</summary><category term="linux"></category><category term="tips"></category></entry><entry><title>WIFI Hotspot Setup On Ubuntu 12.04</title><link href="http://blog.wiseturtles.com/posts/wifi-hotspot-setup-on-ubuntu.html" rel="alternate"></link><updated>2014-12-30T00:00:00+08:00</updated><author><name>Zhang Wanming</name></author><id>tag:blog.wiseturtles.com,2014-12-30:posts/wifi-hotspot-setup-on-ubuntu.html</id><summary type="html">&lt;p&gt;hotspot配置参考：http://thenewbieblog.wordpress.com/2012/05/01/wifi-hotspot-setup-on-ubuntu/
Android利用Fiddler抓包：http://www.trinea.cn/android/android-network-sniffer/&amp;nbsp;Android利用tcpdump抓包：http://www.trinea.cn/android/tcpdump_wireshark/&lt;/p&gt;
&lt;p&gt;为了Ubuntu笔记本方便对Android手机上的Apps做抓包, 本文介绍两种方法，方法二更容易配置。
有线、无线同时可以工作时，用下面方法将无线网卡作为hotspot，通过有线连接外网。
如果想直接通过无线网卡上外网，需要先停掉hostapd 或&amp;nbsp;ap-hotspot，并重启网络。&lt;/p&gt;
&lt;p&gt;重启网络:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sudo service network-manager restart
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;方法一&lt;/h1&gt;
&lt;h2&gt;查看无线网卡硬件信息&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sudo lspci &lt;span class="p"&gt;|&lt;/span&gt; grep -i network
03:00.0 Network controller: Intel Corporation Wireless &lt;span class="m"&gt;7260&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;rev 6b&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;查看无线网卡驱动信息&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;lsmod
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;查看无线网卡设备名称&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;iwconfig
wlan0     IEEE 802.11bgn  Mode:Master  Tx-Power&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt; dBm   
          Retry  long limit:7   RTS thr:off   Fragment thr:off
          Power Management:on
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;安装需要的软件&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sudo apt-get install dhcp3-server hostapd
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;修改/etc/hostapd/hostapd.conf&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;cat /etc/hostapd/hostapd.conf
&lt;span class="nv"&gt;interface&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;wlan0
&lt;span class="nv"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;nl80211
&lt;span class="nv"&gt;ssid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;your_hotspot_name
&lt;span class="nv"&gt;channel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1
&lt;span class="nv"&gt;hw_mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;g
&lt;span class="nv"&gt;auth_algs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1
&lt;span class="nv"&gt;wpa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;3
&lt;span class="nv"&gt;wpa_passphrase&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;your-password
&lt;span class="nv"&gt;wpa_key_mgmt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;WPA-PSK
&lt;span class="nv"&gt;wpa_pairwise&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;TKIP CCMP
&lt;span class="nv"&gt;rsn_pairwise&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CCMP
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;修改/etc/default/isc-dhcp-server&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;grep INTERFACES /etc/default/isc-dhcp-server
&lt;span class="nv"&gt;INTERFACES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;wlan0&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;修改/etc/dhcp/dhcpd.conf&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;配置文件: /etc/dhcp/dhcpd.conf
Make sure the follow lines are Commented out &lt;span class="o"&gt;(&lt;/span&gt; put a &lt;span class="nb"&gt;hash&lt;/span&gt; “#”  sign at the beginning of the line &lt;span class="o"&gt;)&lt;/span&gt; the following lines:
&lt;span class="c"&gt;# option definitions common to all supported networks…&lt;/span&gt;
&lt;span class="c"&gt;#option domain-name “example.org”;&lt;/span&gt;
&lt;span class="c"&gt;#option domain-name-servers ns1.example.org, ns2.example.org;&lt;/span&gt;
&lt;span class="c"&gt;#default-lease-time 600;&lt;/span&gt;
&lt;span class="c"&gt;#max-lease-time 7200;&lt;/span&gt;

Add the following lines to the file &lt;span class="o"&gt;(&lt;/span&gt;copy and paste&lt;span class="o"&gt;)&lt;/span&gt;
subnet 10.10.0.0 netmask 255.255.255.0 &lt;span class="o"&gt;{&lt;/span&gt;
        range 10.10.0.2 10.10.0.16&lt;span class="p"&gt;;&lt;/span&gt;
        option domain-name-servers 8.8.4.4, 208.67.222.222&lt;span class="p"&gt;;&lt;/span&gt;
        option routers 10.10.0.1&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="o"&gt;(&lt;/span&gt;Note: the only other line in this whole config file that is uncommented is :

ddns-update-style none&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;修改/etc/default/hostapd&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;grep -E &lt;span class="s1"&gt;&amp;#39;RUN_DAEMON|DAEMON_CONF|DAEMON_OPTS&amp;#39;&lt;/span&gt; /etc/default/hostapd &lt;span class="p"&gt;|&lt;/span&gt; grep -Ev &lt;span class="s1"&gt;&amp;#39;^#&amp;#39;&lt;/span&gt;
&lt;span class="nv"&gt;RUN_DAEMON&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;yes&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;DAEMON_CONF&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/etc/hostapd/hostapd.conf&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;DAEMON_OPTS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;-dd&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;修改/etc/network/interfaces&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;cat /etc/network/interfaces
auto lo
iface lo inet loopback
auto wlan0
iface wlan0 inet static
    address 10.10.0.1
    netmask 255.255.255.0
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;修改/etc/sysctl.conf&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;grep net.ipv4.ip_forward /etc/sysctl.conf 
net.ipv4.ip_forward&lt;span class="o"&gt;=&lt;/span&gt;1
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;修改/etc/rc.local&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;编辑 /etc/rc.local, 在 &lt;span class="s2"&gt;&amp;quot;exit 0&amp;quot;&lt;/span&gt; 前添加下一行
iptables -t nat -A POSTROUTING -s 10.10.0.0/16 -o ppp0 -j MASQUERADE
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;重启电脑&lt;/h2&gt;
&lt;p&gt;重启电脑，手机测试是否可以连接.&lt;/p&gt;
&lt;h1&gt;方法二&lt;/h1&gt;
&lt;p&gt;用ap-hotspot更容易搭建。&lt;/p&gt;
&lt;h2&gt;ap-hotspot安装、配置&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sudo add-apt-repository ppa:nilarimogard/webupd8
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo apt-get install ap-hotspot
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo ap-hotspot configure &lt;span class="c"&gt;# configure&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo ap-hotspot start &lt;span class="c"&gt;# start&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo ap-hotspot stop &lt;span class="c"&gt;# stop&lt;/span&gt;
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo ap-hotspot restart &lt;span class="c"&gt;# restart&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="Ubuntu"></category></entry><entry><title>Upgrade Ubuntu from 10.04 to 12.04</title><link href="http://blog.wiseturtles.com/posts/upgrade-ubuntu-from-10.04-to-12.04.html" rel="alternate"></link><updated>2014-12-04T00:00:00+08:00</updated><author><name>Zhang Wanming</name></author><id>tag:blog.wiseturtles.com,2014-12-04:posts/upgrade-ubuntu-from-10.04-to-12.04.html</id><summary type="html">&lt;p&gt;公司开发人员电脑都安装的是Ubuntu 10.04，现在越来越不好用，而且，很多同事发现编译最新的Firefox &lt;span class="caps"&gt;OS&lt;/span&gt;都有问题，所以，我尝试升级并把碰到的问题记录下来。&lt;/p&gt;
&lt;h1&gt;升级&lt;/h1&gt;
&lt;h2&gt;修改源&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;cat /etc/apt/sources.list
deb http://172.26.32.18/ubuntu/ lucid main restricted universe multiverse
deb http://172.26.32.18/ubuntu/ lucid-security main restricted universe multiverse
deb http://172.26.32.18/ubuntu/ lucid-updates main restricted universe multiverse
deb http://172.26.32.18/ubuntu/ lucid-proposed main restricted universe multiverse
deb http://172.26.32.18/ubuntu/ lucid-backports main restricted universe multiverse

&lt;span class="c"&gt;# aliyun&lt;/span&gt;
deb http://mirrors.aliyun.com/ubuntu/ lucid main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ lucid-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ lucid-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ lucid-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ lucid-backports main restricted universe multiverse
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;开始升级&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sudo &lt;span class="k"&gt;do&lt;/span&gt;-release-upgrade
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;nis无法启动，导致升级过程中配置nis包失败&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;grep redhat /etc/hosts
172.26.32.12    &lt;span class="nb"&gt;cd&lt;/span&gt;-redhat-001.TCTCD

&lt;span class="nv"&gt;$ &lt;/span&gt;tail -1 /etc/yp.conf 
ypserver &lt;span class="nb"&gt;cd&lt;/span&gt;-redhat-001.TCTCD

&lt;span class="nv"&gt;$ &lt;/span&gt;cat /etc/defaultdomain 
TCTCD

&lt;span class="nv"&gt;$ &lt;/span&gt;grep NIS /etc/default/nis &lt;span class="p"&gt;|&lt;/span&gt; grep -Ev &lt;span class="s1"&gt;&amp;#39;#&amp;#39;&lt;/span&gt;
&lt;span class="nv"&gt;NISSERVER&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;false&lt;/span&gt;
&lt;span class="nv"&gt;NISCLIENT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;NISMASTER&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;

&lt;span class="nv"&gt;$ &lt;/span&gt;cat /etc/auto.master
/home /etc/auto.home

&lt;span class="nv"&gt;$ &lt;/span&gt;cat /etc/auto.home 
xcsu &lt;span class="nb"&gt;cd&lt;/span&gt;-redhat-001.TCTCD:/home/xcsu

&lt;span class="nv"&gt;$ &lt;/span&gt;/usr/lib/yp/ypinit -s &lt;span class="nb"&gt;cd&lt;/span&gt;-redhat-001.TCTCD

&lt;span class="nv"&gt;$ &lt;/span&gt;sudo service portmap restart
&lt;span class="nv"&gt;$ &lt;/span&gt;sudo service nis restart
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;启动后登录时发现只能用administrator和guest登录&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;cat /etc/lightdm/lightdm.conf 
&lt;span class="o"&gt;[&lt;/span&gt;SeatDefaults&lt;span class="o"&gt;]&lt;/span&gt;
user-session&lt;span class="o"&gt;=&lt;/span&gt;ubuntu
greeter-session&lt;span class="o"&gt;=&lt;/span&gt;unity-greeter
allow-guest&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;false&lt;/span&gt;
greeter-show-manual-login&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;重启电脑，就可以用其它用户登录了&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nv"&gt;$ &lt;/span&gt;sudo reboot
&lt;/pre&gt;&lt;/div&gt;</summary><category term="Ubuntu"></category><category term="Nis"></category></entry></feed>